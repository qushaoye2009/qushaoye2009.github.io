(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{294:function(a,t,e){"use strict";e.r(t);var s=e(28),n=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"js全栈koa-vue前后端分离开发分享"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#js全栈koa-vue前后端分离开发分享"}},[a._v("#")]),a._v(" JS全栈koa+vue前后端分离开发分享")]),a._v(" "),e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[a._v("#")]),a._v(" 前言")]),a._v(" "),e("p",[a._v("前端时间分享了一篇TS全栈koa+vue前后端分离开发的文章，里面也分享了其在github上的地址(其中小程序并没有配ts)：")]),a._v(" "),e("ul",[e("li",[a._v("后端："),e("a",{attrs:{href:"https://github.com/yibiankeji/yb-server-koa.git",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/yibiankeji/yb-server-koa.git"),e("OutboundLink")],1)]),a._v(" "),e("li",[a._v("h5: "),e("a",{attrs:{href:"https://github.com/yibiankeji/yb-h5-vue.git",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/yibiankeji/yb-h5-vue.git"),e("OutboundLink")],1)]),a._v(" "),e("li",[a._v("小程序："),e("a",{attrs:{href:"https://github.com/yibiankeji/yb-mp.git",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/yibiankeji/yb-mp.git"),e("OutboundLink")],1)])]),a._v(" "),e("p",[a._v("里面几乎用到了前端所有最新的前沿技术，包括pwa，和测试等，当然使用ts基于react-native或weex开发原生APP的并没有分享！")]),a._v(" "),e("p",[a._v("后来发现，前端还是小白居多，实际场景还是中小项目居多，且前端基础普遍薄弱，一下接受太多新东西，反而影响了开发效率。")]),a._v(" "),e("p",[a._v("所以后来，我去掉测试，pwa和ts等锦上添花的功能，转而专注在对koa和vue基础使用上，于是指导两个小白准备了这套js全栈koa+vue的前后端开发分享。")]),a._v(" "),e("p",[a._v("本项目主要实现登录注册、token校验，修改密码，上传头像和修改用户信息和列表下拉刷新、上拉加载等功能，没有具体的业务应用场景，但真实业务改改即可用来部署上线。")]),a._v(" "),e("p",[a._v("本人在阿里云服务器正在使用的一套JS全栈系统就基于此，包括h5，pc后端，小程序和node后端。")]),a._v(" "),e("h2",{attrs:{id:"技术架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#技术架构"}},[a._v("#")]),a._v(" 技术架构")]),a._v(" "),e("p",[a._v("前后端分离，后端没有选用大而全360的thinkjs\b或定制化阿里的egg, 而是基于它们底层都使用的web开发\b框架 koa, 同时前端基于vue 最新脚手架cli 3.x 搭建：")]),a._v(" "),e("ul",[e("li",[a._v("后端使用sequelize作为ORM操作mysql数据库, 使用koa-jwt进行token校验，使用koa-body实现图片上传等，核心库当前版本为：\n"),e("ul",[e("li",[a._v("node v10.13.0,")]),a._v(" "),e("li",[a._v("koa 2.6.x,")]),a._v(" "),e("li",[a._v("sequelize 4.41.x,")]),a._v(" "),e("li",[a._v("koa-jwt 3.5.x,")]),a._v(" "),e("li",[a._v("koa-body 4.0.x等。")])])]),a._v(" "),e("li",[a._v("前端使用官方路由库vue-router管理页面切换，官方状态库管vuex公共数据，使用axios处理请求，滴滴基于vue的移动端组件库cube-ui框架等：\n"),e("ul",[e("li",[a._v("vue 2.5.17,")]),a._v(" "),e("li",[a._v("vue-router 3.0.1,")]),a._v(" "),e("li",[a._v("vuex 3.0.1,")]),a._v(" "),e("li",[a._v("axios 0.18.0,")]),a._v(" "),e("li",[a._v("cube-ui 1.12.2")])])])]),a._v(" "),e("h2",{attrs:{id:"启动系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动系统"}},[a._v("#")]),a._v(" 启动系统")]),a._v(" "),e("ul",[e("li",[a._v("koa后端\n"),e("ul",[e("li",[a._v("下载源码"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  git clone https://github.com/yibiankeji/js-server-koa.git   \n")])])])]),a._v(" "),e("li",[a._v("\b安装项目有关依赖"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  cd js-server-koa &&  npm install \n")])])])]),a._v(" "),e("li",[a._v("安装mysql数据库并创建项目数据库"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  brew install mysql (mac下安装，其他安装上网搜)\n  mysql -u root -p   //进入数据库，需输密码\n  create database ybkj;    //创建数据库\n  exit  //退出数据库\n")])])])]),a._v(" "),e("li",[a._v("启动项目"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  npm start  \n")])])])]),a._v(" "),e("li",[a._v("\b测试服务"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('  curl -H "Content-Type:application/json" -X POST -d \'{"username":"18911681482", "password":"123456"}\' http://localhost:8888/api/user/login\n  // 若未创建，返回用户不存在即说明成功\n')])])])])])]),a._v(" "),e("li",[a._v("vue h5\n"),e("ul",[e("li",[a._v("下载源码"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  git clone https://github.com/yibiankeji/js-h5-vue.git   \n")])])])]),a._v(" "),e("li",[a._v("\b安装项目有关依赖"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  cd js-h5-vue &&  npm install \n")])])])]),a._v(" "),e("li",[a._v("启动项目"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("  npm start  \n")])])])])])])]),a._v(" "),e("h2",{attrs:{id:"上线部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#上线部署"}},[a._v("#")]),a._v(" 上线部署")]),a._v(" "),e("p",[a._v("项目代码里面并没有基于pm2上线部署的分享，这里只简单提一下，如有需要，请加我qq私聊。")]),a._v(" "),e("h3",{attrs:{id:"配置服务器免密登陆"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置服务器免密登陆"}},[a._v("#")]),a._v(" 配置服务器免密登陆")]),a._v(" "),e("p",[a._v("将本地Mac生成的公钥 添加到远程服务器")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ssh-keygen\nssh-copy-id -i .ssh/id_rsa.pub 用户名@47.92.xx.xxx\n")])])]),e("h3",{attrs:{id:"安装pm2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装pm2"}},[a._v("#")]),a._v(" \b安装pm2 \b")]),a._v(" "),e("p",[a._v("在本地电脑安装pm2工具")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("npm install -g pm2\n")])])]),e("h3",{attrs:{id:"初始化配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#初始化配置文件"}},[a._v("#")]),a._v(" 初始化配置文件")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("pm2 ecosytem\n")])])]),e("p",[a._v("记得改成json格式，后端参考的例子如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('{\n  apps : [\n    {\n      name: "server",\n      script: "src/app.js",\n      env: {\n        COMMON_VARIABLE: "true"\n      },\n      env_production : {\n        NODE_ENV: "production"\n      }\n    }\n  ],\n  deploy : {\n    production : {\n      user: "xqart",\n      host: "47.xx.xxx.xxx",\n      ref: "origin/master",\n      repo: "git@github.com:yibiankeji/js-server-koa.git ",\n      path: "/home/study/server",\n      "post-deploy": "git pull && npm install && pm2 start ecosystem.json --env production"\n    }\n  }\n}\n\n')])])]),e("p",[a._v("h5参考的例子如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('{\n  apps : [\n    {\n      name: "h5",\n      script: "build/build.js",\n      env: {\n        COMMON_VARIABLE: "true"\n      },\n      env_production : {\n        NODE_ENV: "production"\n      }\n    }\n  ],\n  deploy : {\n    production : {\n      user : "xqart",\n      host : "47.xx.xxx.xxx",\n      ref  : "origin/master",\n      repo : "git@github.com:yibiankeji/js-h5-vue.git",\n      path : "/home/study/h5",\n      "post-deploy" : "git pull && npm install && npm run build"\n    }\n  }\n}\n\n\n')])])]),e("h3",{attrs:{id:"初始化远程服务器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#初始化远程服务器"}},[a._v("#")]),a._v(" 初始化\b远程服务器")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("pm2 deploy production setup\n")])])]),e("h3",{attrs:{id:"部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[a._v("#")]),a._v(" 部署")]),a._v(" "),e("p",[a._v("在两个项目下分别执行：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("pm2 deploy production\n")])])]),e("p",[a._v("然后就可以在本地电脑一键部署到远程云服务器了！而对于nginx的安装和配置，这里就不多说了，具体看我简书关于部署的博客。")])])}),[],!1,null,null,null);t.default=n.exports}}]);